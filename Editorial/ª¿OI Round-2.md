

| 题目名称    | 电功率       | 忏悔          | 审视          | 封建          | *~={red}ExP=~* |
| :------ | :-------- | :---------- | :---------- | :---------- | :------------- |
| 题目类型    | 传统型       | 传统型         | 传统型         | 传统型         | 传统型            |
| 目录      | power     | confess     | observe     | janefly     | 无              |
| 可执行文件名  | power     | confess     | observe     | janefly     | 无              |
| 输入文件名   | power.in  | confess.in  | observe.in  | janefly.in  | 无              |
| 输出文件名   | power.out | confess.out | observe.out | janefly.out | 无              |
| 每个测试点时限 | 1.0 秒     | 1.0 秒       | 1.0 秒       | 1.0 秒       | 无测试点           |
| 空间限制    | 128 MiB   | 128 MiB     | 128 MiB     | 128 MiB     | 无测试点           |
| 测试点数目   | 20        | 10          | 20          | 20          | 0              |
| 满分      | 100       | 100         | 100         | 100         | $+\infty$      |
| 测试点是否等分 | 是         | 是           | 是           | 是           | 无测试点           |
| 优化      | 无         | 无           | 无           | 无           | 无              |

提交源文件程序名

| 对于 C++语言 | power.cpp | confess.cpp | observe.cpp | janefly.cpp |     |
| -------- | --------- | ----------- | ----------- | ----------- | --- |

编译选项

| 对于 C++语言 | 你似乎并不用知道这个，你只需要知道 C++14 (O2) |
| -------- | ---------------------------- |

**注意事项（请仔细阅读）**
1. 本场比赛为 CSP-J 信心赛，题目难度按照出题人主观评定，不提供形式化题意。
2. 题目背景大多根据真实情况虚构，请勿当真。
3. 比赛过程中选手电脑断网，请勿使用自带电脑进行答题。
4. 请独立完成本套试题。
5. 本场比赛题目相对简单，AK 后请勿喧哗。
6. Revitalize（UID：553192） 供题，祝大家 AK 愉快。
7. 本套题目中的事件纯属虚构，但人物存在原型。
8. **本校模拟赛题不得外传，包括但不限于：拷题，在任何网站记录题目信息（包括洛谷非公开云剪贴板，非公开题目等），向在线 AI 询问题目，或任何可能造成其他人员获取题目的操作。** 

---

$$
\text{这是一场数据结构的盛宴。} 
$$
$$
\mathrm{同时难度适中，思维难度_{高}}{，代码难度\Large低}。
$$
$$
\text{希望大家尽情享受。}
$$
# 反抗（refight）
## 题目背景

“快点！”炎炎烈日下，厉斥声与惨叫声交织在一起，蒸发在了灼热的空气中。  
染着血色的长鞭撕裂空气，在手中呼呼作响。  
土地里，汗水、血水参杂着，化作了独特的肥料。  
脚镣磨动，发出刺耳的金属声。  
不久，干裂的田垄上又一枪与哀鸣，那被染红的土壤再次蔓延。  
“不要再出了……停下……快停下……”

## 题目描述    

**本题有多组数据。**
长时间的压迫使得 Sci_qud 大佬必须站起来反抗。  
他不能再忍受 Collapsarr 那一套刑具的折磨：残忍的分块，令人撕心裂肺的构造，还有使人痛不欲生的积分……  
他励志要自由，要推翻 Collapsarr 的暴政，可惜 Collapsarr 又一次发明了新的刑罚：数论。   
幸运的是，数论可是 Sci_qud 大佬的强项，他有自信，不在数论方面被压迫。  

他认为，一个正整数含有立方因子，那么这个数就是“具有反抗精神的”。  
他定义所有具有反抗精神的正整数构成的集合为 $\mathbb{Y}$。
众所周知，每个正整数都可以被分解成若干质数的幂之积，即 $\displaystyle\prod_{i=1}^k p_i^{c_i}$。  
他定义，对于一个正整数 $x=\displaystyle\prod_{i=1}^k p_i^{c_i},x'=\displaystyle\prod_{i=1}^k p_i$。
根据此，他创造了一些绝妙的函数：
（1）$\beta(x)=\displaystyle\sum_{i=1}^n c_i$。
（2）$\omega(x)$ 为 $x$ 的不同质因数个数，即 $k$。
（3）$d(x)$ 为 $x$ 的因数个数。
（4）
$$
\Xi(x)=\begin{cases}
1&,x=1\\
0&,x\in\mathbb{Y}\\
(-1)^{\beta(x)}&,x\ne x'\\
d(x)(-1)^{\omega(x)} &,x=x'
\end{cases}
$$
现在，Sci_qud 大佬想让你求出：
$$
\sum_{x=1}^n\sigma(x)\sum_{i=1}^{\lfloor\frac{n}{x}\rfloor}\sum_{j=1}^{\lfloor\frac{n}{x}\rfloor}\Xi({\gcd(i,j)})
$$
模 $998244853$ 的值。
## 输入格式
从 $\texttt{refight.in}$ 中读入数据。
第一行输入一个整数 $T$，代表数据组数。
接下来 $T$ 行，每行一个整数 $n$。
## 输出格式
输出到文件 $\texttt{refight.out}$ 中。  
每行输出一个整数，代表答案。
## 输入输出样例
### 输入 #1

```
5
10
127
17
114514
919810
```

### 输出 #1

```
136
34930
432
271653851
667675837
```

## 说明/提示
对于 $30\%$ 的数据，$T\le50,n\le100$。
对于 $100\%$ 的数据，$T\le10^3,n\le10^6,p=998244853$。


---

# 忏悔（confess）

## 题目背景

**相关前置知识请在题目附件中查看。**  
**好好学数学，尤其是高中数学，大学数学，才能搞 OI，数学学不好一切白搭。——来自出题人的忠告**

他是一个无神论者。  
他坚定不移的相信科学，从始龀到不惑，一如既往。  
在他心目中，物理与数学是一切的真谛，他信仰这那纯粹的理性。  
他，这位大名鼎鼎的物理学家的生命，刚刚定格。  
他最后的容貌充满了恐惧，仿佛世界末日那般绝望。  

“”

## 题目描述

“温和慈祥”的 HydrogenTungsten 发现他的学生现在非常的颓废，对于这门学科十分不重视，于是他决定整顿一下班风。
班里有 $n$ 名同学，每个人都有一个学号 $i$ 以及 $a_i$。  
其中 $a_i$ 值小的同学更加的抽象，他们喜欢拆卸凳子，把他人关进生态瓶或者凭第六感做作业。  
而 $a_i$ 值大的同学则比较具象，他们能非常好的执行老师的指令。
HydrogenTungsten 发现，他可以选择一段连续的学号区间 $[l,r]$，并毫无选择的以同样的力度 $k$ 制裁学号在这段区间内的所有学生，而这样会使这些学生的 $a_i$ 值加上 $k$。
同时，他还要对自己的管理成果进行考察。  
每次考察，它可以选择一段学号区间 $[l,r]$，并求出  $\sum_{i=l}^r f(a_i) \bmod 998244353$ 的值。  
其中 $f(a_i)$ 表示第 $i$ 个学生的“物理水平”。    
HydrogenTungsten 认为一个学生的物理水平由两个正整常数 $x,y$，决定，它定义为：
$$
f(i)=\begin{cases}
1&,i=1,2\\
xf_{i-2}+yf_{i-1}&,\text{otherwise}\\
\end{cases}
$$
幸运的是，学生的 $a_i$ 值经过整治后普遍较大。  
但 HydrogenTungsten 对此并不满意。  
因为他没有理由整治学生了。  
于是为了使同学们的 $a_i$ 值普遍较小，他想到了一个好方法。  
那就是对 $a_i$ 求 $\sin,\cos$ 的值。  
这样它们的范围就被缩小到了 $[-1,1]$。  
所以 HydrogenTungsten 会认为 $\sum_{i=l}^r\sin(a_i)$ 才是学生的真实情况，所以他会把这个数值上报给班主任。  
当然，有时他也会上报 $\sum_{i=l}^r\cos(a_i)$ 的值。   
对于这两种三角函数的询问，他会取到 $4$ 位小数。
注意，询问 $f(a_i),\sin,\cos$ 的操作不对 $a_i$ 进行修改, 它们只是查询操作。
他一共会执行 $m$ 次操作。

## 输入格式

从 $\texttt{confess.in}$ 中读入数据。  
第一行输入四个整数 $n,m,x,y$。  
第二行输入 $n$ 个整数 $a_i$。
接下来 $m$ 行，每行先输入一个整数 $op$。
如果 $op=1$，那么输入三个整数 $l,r,k$，代表修改操作。  
如果 $op=2$，那么输入两个整数 $l,r$，代表询问 $f$ 操作。  
如果 $op=3$，那么输入两个整数 $l,r$，代表无意义的操作。
如果 $op=4$，那么输入两个整数 $l,r$，代表询问 $\sin$ 操作。
如果 $op=5$，那么输入两个整数 $l,r$，代表询问 $\cos$ 操作。
注意，如果输入的 $l>r$，请交换它们。
## 输出格式

输出到文件 $\texttt{confess.out}$ 中。  
对于每一个查询操作，输出一个整数，代表答案。  
特别地，如果 $op=3$，输出 $\log_72$ 的值，取小数点后 $4$ 位。

## 输入输出样例 
## 说明/提示

对于 $100\%$ 的数据，保证 $1\le n\le 3\times10^5,a_i\le10^6,k\le10^6$。

---


# 审视（observe）

## 题目背景



## 题目描述

HydrogenTungsten 终于上公开课了。  
站在偌大的阶梯教室中，他的语言变得平和，再也不说“优美动听”的语言了。
学校的阶梯教室非常奇怪，有 $n$ 个座位，每个座位都有一个编号，座位之间有一些长度为 $1$ 的过道，每一条过道连接两个座位。  
一共有恰好 $n-1$ 个过道，且任意两个作为经过若干个过道都能互相到达。  
特别地，老师的位置位于阶梯教室的末端，不妨认为这个位置就是 $1$ 号，也就是树根。  
HydrogenTungsten 的课上座无虚席，他给每个同学都发了一个讲义。  
每个讲义可能都不一样，但也或许有些讲义一样。   
至少 HydrogenTungsten 认为，每一本讲义都可以抽象成一个英文小写字母。    
讲课的时候，HydrogenTungsten 需要不时地盯着大家的听课情况。  
有时他会随便挑两个节点 $u,v$，然后从 $u$ 开始，顺着树上的路径审视路径上的同学的笔记，直到 $v$ 审视完成。   
途中，他会将沿途看到的学生的讲义的字母顺次在脑海中拼成一个字符串 $a$。  
然后他又从 $v$ 开始往回看，一直看到 $u$，然后又顺次把看到的学生的讲义的字母拼成字符串 $b$。  
然后他比较 $a,b$，如果 $a=b$，他就认为这段路径上的学生听课很认真，并说 `UIT` 。  
否则，他就会很愤怒，大喊 `ZHQ`。
当然，学生们会不停地在讲义上做笔记。  
此时他的讲义会变成另一个英文小写字母。
他的公开课中共有 $m$ 个时间节点，每个节点上，或许 HydrogenTungsten 开始审视大家的作业，也或许某个学生在讲义上记了一些笔记，注意 HydrogenTungsten 也会修改自己的讲义。
现在，给你这个阶梯教室的结构以及初始时学生讲义的字母以及每个时间节点的事件，求出每次 HydrogenTungsten 进行审视后说的话。

## 输入格式

从 $\texttt{observe.in}$ 中读入数据。  
第一行输入一个整数 $n$。
第二行输入一个字符串 $s$，$s_i$ 代表初始时第 $i+1$ 号座位上发的讲义的字母。  
因为字符串是以 $0$ 为下标开头的，所以是 $i+1$。
接下来 $n-1$ 行，每行两个整数 $u,v$，代表一条过道。  
第 $n+2$ 行输入一个整数 $m$。  
接下来 $m$ 行，每行先输入一个整数 $op$， 
如果 $op=1$，那么接下来输入两个整数 $u,v$，代表审视。  
如果 $op=2$，那么接下来输入一个整数与一个字符 $x,y$，代表第 $x$ 个座位上的学生将讲义字母改为 $y$。

## 输出格式

输出到文件 $\texttt{observe.out}$ 中。  
对于每次审视，输出一个字符串。
## 输入输出样例
### 输入 #1
```
1
2
```
### 输出 #1
```
5
```
### 输入 #2
```
1
100000
```
### 输出 #2
```
72434344904
```

## 说明/提示

对于 $30\%$ 的数据，保证 $n,m\le2\times10^3$。  
对于另 $20\%$ 的数据，保证树是一条链。 

___
# 封建 (janefly)
## 题目背景  

“为什么你没有上节课的笔记？”  
HydrogenTungsten 勃然大怒，抬起握着书的手，狠狠砸下。 
“上节课还没讲到这里……”众人喧哗道。  
“啊？哦，我记成隔壁班了。”  

*There is no apologize!*

## 题目描述

HydrogenTungsten 给了你一棵有根树。  
我们将从 $D_1$ 到 $D_s$ ，依次经过 $D_1,D_2,\cdots,D_s$ 的路径 $P$ 记作：$\operatorname{Path}(D_1,D_s)$。    
定义 $P$ 的子路径为集合 $\set{\operatorname{Path}(D_l,D_r)|1\le l\le r\le s}$，记作 $S(D_1,D_s)$。
现在每个点都有一个点权 $A_i$。
现在定义 $f(l,r)$ 为路径 $<l,r>$ 上所有点的点权的中位数。  
也就是将这些点权从小到大排序后第 $\lfloor\dfrac{E+1}{2}\rfloor$ 个值。  
其中 $E$ 为 $\operatorname{Path}(l,r)$ 上点的个数。
HydrogenTungsten 现在有 $m$ 次操作，每次操作给定两个数 $u,v$，保证 $u$ 不是 $v$ 的祖先，$v$ 不是 $u$ 的祖先。  
他请你求出：
$$
\max_{i=1}^n\max_{j=1}^n [\operatorname{Path}(i,j)\in S(u,v)]f(i,j)
$$
的值。

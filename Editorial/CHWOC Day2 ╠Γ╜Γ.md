>
>文化课搞不好，将来退役了能干啥？
>

| 题目编号 | T1  |     T2     |   T3    |   T4   |     T5     |       T6       |
| :--: | :-: | :--------: | :-----: | :----: | :--------: | :------------: |
| 题目名称 |  春  |    赳赳老秦    |   出师表   |   关雎   |    陈涉世家    |     湖心亭看雪      |
|  难度  |  黄  |     紫      |    蓝    |   橙    |     黄      |       紫        |
| 主要算法 | 诈骗  | 杜教筛，狄利克雷卷积 | 线段树，位运算 | 模拟，前缀和 | （非随机）赋权，同余 | DP，狄利克雷卷积, ，组合 |
# T1
### 背景分析
七年级上第一篇课文，要求全文背诵。  
背的时候注意一些细节，总体上不难。
### 100 分
谨防电信诈骗，从你我做起。  
模数很重要，有的时候 $2^{64}$ 作为模数不一定是让你开 `unsigned int long long`，而是有一些奇怪性质。  
原式形如：
$$
\left(\prod_{i=1}^n\prod_{j=i+1}^n(a_i\oplus a_j)\right)\bmod2^{64}
$$
那么我们不妨将异或改为减号，得到：
$$
\left(\prod_{i=1}^n\prod_{j=i+1}^n(a_i-a_j)\right)\bmod2^{64}
$$
熟悉的同学可能会看出，这个式子利用洛必达法则以及多项式多点求值目前最好才可以做到 $O(n\log^2n)$。  
减法至少对乘法还有分配律，异或和乘法则几乎没有关系，这警示我们此题**可能**没有常规解法。  
~~话不能说绝对，万一您能拿图灵奖呢？~~  
我们考虑，每 $3$ 个数中，必有一对数异或起来是偶数，所以当 $n$ 较大的时候，$a_i\oplus a_j$ 中偶数的数量就会远远超过 $64$，此时它们乘起来模 $2^{64}$ 就会得到 $0$。  
$0$ 乘上任何数都为 $0$，可以直接结束程序了。  
所以在暴力乘起来的时候加上一个剪枝，及时退出循环即可通过。

> 
> 做一道题好好想正解，不要天天想着用奇怪的做法**草**过去。   ——MHJ
>
# T2
### 背景分析
2024 年中考真题。  
原文选自《2021中国年度作品·小小说》，选文有改动，作者肖建国。

---
11. 孟将军口中的老者，为什么让李岩觉得“不简单”？（3 分）
12. 请结合语境，回答下面的问题。（4 分）
	（A）处画线部分，让两个“是”独立成句、成段，有什么好处？（2 分）
	（B）处画线句子写孟将军心里仔细计算手下大将亲兵数量，这个心理活动反映了他怎样的胜负观？（2 分）
13. 小说所写孟将军三次拔刀的情节，有什么不同？写他三次拔刀有何作用？（6 分）
14. 小说结尾，孟将军“放声大哭”，他究竟因何而哭？请谈谈你的理解。（4 分）
15. 这篇小说的结尾留下了想象的空间。依据你对结尾的理解和建构，说说文中能称得上“赳赳老秦”的有谁，并简述理由。（4分）
---

可能算是陕西中考改革的第一步吧。  
题比较新颖。
### 10 分
从到 $1$ 到 $n$，一路枚举，并且采用笨办法分解质因数，复杂度 $O(n^2)$。  
即可拿到 $10$ 分。
### 20 分
对于一个正整数 $n$ 来说，显然其至多只有一个质因子大于 $\sqrt{n}$，因此我们只需要枚举 $\sqrt{n}$ 以内的质因数即可，每枚举到一个质因子后就让 $n$ 一直除以这个质因子，直到无法整除为止，最后自然只剩下的那一个大于 $\sqrt{n}$ 的质因数（可能不存在）了。  
于是我们得到了 $O(n\sqrt{n})$ 做法。
### 30 分 
既然答案需要我们算出 B 的得分减去 A 的得分，那我们不妨让 A 加一分转换成答案加负一分。  
于是很自然地可以定义 $r(n)$ 为 $(-1)^{\sum a_i}$，其中 $a_i$ 是 $n$ 的第 $i$ 个质因子的次数，并且 $r(1)=1$。  
答案就是 $r(1)+r(2)+\cdots+r(n)$。    
显然 $r$ 是一个积性函数，甚至是完全积性函数。
因此用埃氏筛可以 $O(n\log\log n)$ 预处理出 $r$，直接求和就行。  
### 60 分
拿到 30 分自然得会 60 分了吧。  
埃氏筛显然是逗你玩的啊，欧拉筛 $O(n)$ 那么好为啥不用？   
欧拉筛求积性函数应该是普及组内容吧。
### 100 分
积性函数求和问题显然有更快的做法。  
你会发现，$r$ 其实跟 $\mu$ 长得挺像。  
莫反公式告诉我们 $\mu*1=\epsilon$。  
那 $r$ 也卷个 $1$ 试试？ 
显然可以得到 $r(n)*1(n)=[\exists k\in \mathbb{N}^+,k^2|n]$。  
说人话，设 $r*1=f$，那么 $f(n)=1$ 当且仅当 $n$ 是完全平方数。  
这个规律打个表也出来了。
证明的话考虑因为 $r$ 是积性函数，所以你只需要证明对于 $r(p^k)$ 成立即可。  
而这是显然的，只有 $k$ 为偶数时才能让 $r(p^k)=1$。  
$1$ 的前缀和很好求吧？$f$ 也很好求吧？  
那就可以杜教筛了！  
复杂度 $O(n^{\frac{2}{3}})$，可以通过，而且不卡常。
# T3
### 背景分析
都说《出师表》难背，其实很朗朗上口，十分好背。  
### 25 分
随便暴力。
### 100 分
原题啊，原题！
我们考虑对于每个数二进制拆位成 $30$ 位，不足 $30$ 位的补上前导 $0$。  
#### 操作 1
区间或。    
考虑先把 $k$ 二进制拆位。  
对于是 $1$ 的位，维护该位的的线段树进行区间修改为 $1$ 的操作。  
对于是 $0$ 的位，不管。  
#### 操作 2
区间与。    
考虑先把 $k$ 二进制拆位。  
对于是 $0$ 的位，维护该位的的线段树进行区间修改为 $0$ 的操作。  
对于是 $1$ 的位，不管。 
#### 操作 3
区间异或。    
考虑先把 $k$ 二进制拆位。  
对于是 $1$ 的位，维护该位的的线段树进行区间 $1$ 变 $0$，$0$ 变 $1$ 的操作。  
对于是 $0$ 的位，不管。
#### 操作 4
区间和。      
对于维护第 $k$ 位的线段树，$ans\gets ans+2^k\times query$。  
$query$ 就是正常的区间和查询。  
#### 操作 5
化简式子，发现要求的是：  
从 $a_l$ 到 $a_r$，找到一个区间的最大的子区间，使得该子区间的所有数的第 $k$ 位都是 $1$。  
那不就是求出维护第 $k$ 位的线段树的区间最大子段和吗？
#### 操作 6
化简式子，发现要求的是：  
从 $a_l$ 到 $a_r$，找到一个区间的最大的子区间，使得该子区间的所有数的第 $k$ 位都是 $0$。  
那不就是求出维护第 $k$ 位的线段树的区间最大全零子段吗？  
这玩意的原理其实与最大子段和差不多吧。  

你会发现直接用懒标记维护就可以。  
因为可以 $O(1)$ 修改线段树某个节点的值。  

首先区间全赋为一操作，那就是前缀最大和，后缀最大和，最大子段和以及区间和都改成区间长度，前缀全 0 子段最大长度，后缀全 0 子段最大长度，区间最长全 0 子段长度都设为 0 就好了，最后再打上 tag 就好。  
区间全赋 0 操作反过来就行。  
区间取反就是把维护的关于 1 的信息与关于 0 的信息 `swap` 一下，区间和更新一下，打上 tag，再反转 0 的 tag 与 1 的 tag 就好了。  
非常简单。  
# T4
### 背景分析
讲关雎的时候 LX 听得十分认真（
### 100 分
模拟题，按照题面模拟，变换循环顺序，即可拿到 100 分。  
实在不想多说。
# T5
### 背景分析
其实这个不用背的。  
不过出题人似乎曾经背过，但是早忘了。  
并不太好背，不过可以接受。
### 40 分
前面字符串长度 <= 5 的部分是给手玩的，虽然可能比较麻烦。对于长度 $\le 8$，由于 A, B 与 C, D, E 可以任意交换位置，不妨将 AB 都换到字符串的前面，CDE 在后面（不改变 AB 内部，CDE 内部的相对顺序）。两部分的判断就独立了。

考虑直接搜索两个字符串是否能够经过操作变化得到，手玩可以发现，只要不把字符串删空，操作就是**可逆**的。并且可以合理安排操作顺序，使得操作过程中的串长 $\le 8$ 删除的最大串长。考虑对于 AB，对串长 $\le 12$ 的所有串 BFS 连通性；对于 CDE，对串长 $\le 11$ 的所有串 BFS 连通性。

对于询问，只需要扫描一遍，得到两个串由 AB 构成的极长子序列和 CDE 构成的极长子序列，如果两者都连通，那么答案就是 `YES`，其他情况就是 `NO`。

时间复杂度 $O(3^{11} \times \operatorname{poly}(|s|,|t|) + q \times (|s|+|t|))$。  
这玩意比正解还难写啊……这档部分分纯没用的，就是让你手玩的。

### 特殊性质 A：20 分
对搜索打表（或者受[题](https://www.luogu.com.cn/problem/AT_arc071_c)的启发），观察位于同于连通块的串，你可以发现 `AB`, `BA`, `AAAA`, `BBBB` 位于同一连通块，`A`, `AAB`, `ABA`, `BAA`... 位于同一连通块，`B`, `BAB`, `BBA`, `ABB`... 位于同一连通块，`AA`, `BB`, `AAAB`, `AABA`, `ABAA`, `BAAA`... 位于同一连通块，可以猜想连通性与字母的顺序无关，只与字母的个数有关。且连通块个数为 4，考虑对字母赋一个权值，计算字符串在 $\bmod 4$ 意义下的权值和，权值相等的字符串就在同一连通块内。则 $w_A = 1,w_B = 3$ 就是一个合法的解，容易手玩验证在字符串较短的情况，“拼接字符串”操作与“权值相加取模”操作等价，更长的字符串归纳证明即可。

那么只需要预处理前缀和，每次询问区间和 $\bmod 4$ 是否相等。时间复杂度 $O(|s|+|t|+q)$。

### 特殊性质 B：20 分
类比特殊性质 A。你可以考虑设 $w_C = a , w_D = b , w_E = c$，解一个同余方程组：

$$
\left \{\begin{matrix}
a \equiv 2b+c \pmod m\\
b \equiv 2c \pmod m\\
c \equiv a+b \pmod m\\
2a+b \equiv 0 \pmod m\\
3b \equiv 0 \pmod m
\end{matrix}\right .
$$

将前两行代入第三行，可以得到 

$$
c \equiv 7c \pmod m
$$

即 $m$ 是 $6$ 的因数，不妨设 $m$ 为 $6$。
由于字母在操作中地位并不相等，可以寻找一组 $a,b,c$ 互不相等的解，
枚举 $c$ 的值，可以发现，$a=5,b=2,c=1$ 和 $a=1,b=4,c=5$ 均可。
可以得到，$w_C = 5,w_D = 2,w_E = 1$，求区间和 $\bmod 6$ 是否相等。
### 100 分
将特殊性质 A 和特殊性质 B 的做法拼在一起即可。时间复杂度 $O(|s|+|t|+q)$。

# T6-Easy Ver.
### 背景分析
作者描述的真的很唯美。  
但是实际上湖心亭是西湖中淤泥无处安放人工堆起来的。
意境瞬间没了。
### 20 分
用脚写都能拿 20 分吧。
### 40 分
暴力 DP。  
设 $dp_{i,j}$ 为 $i$ 个数，乘积为 $j$ 的方案数。  
显然有 $dp_{i,j}=\displaystyle\sum_{k|j}dp_{i-1,k}$。  
暴力枚举因数， $O(nm^2)$。
### 50 分
因数总是呈对出现的（除了 $\sqrt{x}$ 是整数以外）。  
因此，每一个小于 $\sqrt{x}$ 的因数 $k$ 都对应另一个大于 $\sqrt{x}$ 的因数 $\frac{n}{k}$。  
所以枚举因数时，枚举到 $\sqrt{x}$ 就可以了。  
复杂度 $O(nm^{1.5})$。  
### 70 分
或许会有新奇做法。
### A 性质
答案显然一定是 $n$。
### B 性质
重温 DP 式，$dp_{i,j}=\displaystyle\sum_{k|j}dp_{i-1,k}$。  
设 $f_i(j)=dp_{i,j}$，则 $f_i=f_{i-1}*1$。  
那答案就是 $1^{n}$，其中这个指数是若干个狄利克雷卷积的叠加。  
因为 $1$ 是积性的，所以 $1^{n}$ 也是积性的。  
所以仅需考虑 $1^n(p^k)$。  
首先 $1(p^k)=1$。  
然后 $1^2=d$，并且有 $d(p^k)=k+1$。  
继续，$1^3(p^k)=\displaystyle\sum_{i=0}^kd(p^i)=\dfrac{(k+1)(k+2)}{2}$。  
没看出规律，再继续，$1^4(p_k)=\displaystyle\sum_{i=0}^k\dfrac{(i+1)(i+2)}{2}=\dfrac{(i+1)(i+2)(i+3)}{6}$。  
应该看出来了吧，$1^n(p^k)=\dfrac{(k+n-1)!}{k!(n-1)!}=\dbinom{n+k-1}{k}$。  
数学归纳一下即可证明。
预处理阶乘，做完了，复杂度 $O(n)$。
### 100 分
对 $m$ 分解质因数，相当于若干个 B 性质，复杂度 $O(n+\sqrt{m})$。  
其实应该整个 Pollard-rho，做到 $O(n+\sqrt[4]{m})$，不过这太变态了，还是算了。
# T6-Hard Ver.
### 背景分析
沼兴是有深意的。  
野花是有深意的。
梅菜汤是有深意的。  
大模拟是有深意的。  
### 20 分
用脚写都能拿 20 分吧。
### 40 分
暴力 DP。  
设 $dp_{i,j}$ 为 $i$ 个数构成的与 $j$ 相关的所有序列的权值和。  
显然有 $dp_{i,j}=\displaystyle\sum_{k|j}dp_{i-1,k}\mu(\frac{j}{k})$。    
欧拉筛算 $\mu$，暴力枚举因数， $O(nm^2)$。  
### 50 分
因数总是呈对出现的（除了 $\sqrt{x}$ 是整数以外）。  
因此，每一个小于 $\sqrt{x}$ 的因数 $k$ 都对应另一个大于 $\sqrt{x}$ 的因数 $\frac{n}{k}$。  
所以枚举因数时，枚举到 $\sqrt{x}$ 就可以了。  
复杂度 $O(nm^{1.5})$。  
### 70 分
或许会有新奇做法。
### A 性质
答案显然一定是 $\mu(m)$。
### B 性质
重温 DP 式，$dp_{i,j}=\displaystyle\sum_{k|j}dp_{i-1,k}\mu(\frac{j}{k})$。  
设 $f_i(j)=dp_{i,j}$，则 $f_i=f_{i-1}*\mu$。  
那答案就是 $\mu^{n}$，其中这个指数是若干个狄利克雷卷积的叠加。  
因为 $\mu$ 是积性的，所以 $\mu^{n}$ 也是积性的。  
所以仅需考虑 $\mu^n(p^k)$。  
首先：
$$
\mu(p^k)=\begin{cases}0&,k\ge 2\\-1&,k=1\\1&,k=0\end{cases}
$$
然后推导并不难：
$$
\mu^2(p^k)=\begin{cases}0&,k\ge 3\\1&,k=2\\-2&,k=1\\1&,k=0\end{cases}
$$
继续：
$$
\mu^3(p^k)=\begin{cases}0&,k\ge4\\-1&,k= 3\\3&,k=2\\-3&,k=1\\1&,k=0\end{cases}
$$
这不应该没看出规律了吧，再继续：
$$
\mu^4(p^k)=\begin{cases}0&,k\ge 5\\1&,k=4\\-4&,k= 3\\6&,k=2\\-4&,k=1\\1&,k=0\end{cases}
$$
应该看出来了吧，杨辉三角啊，就是二项式系数：
$$
\mu^n(p^k)=\begin{cases}0&,k>n\\(-1)^k\dbinom{n}{k}&,k\le n\end{cases}
$$
数学归纳一下即可证明。
预处理阶乘，做完了，复杂度 $O(n)$。
### 100 分
对 $m$ 分解质因数，相当于若干个 B 性质，复杂度 $O(n+\sqrt{m})$。  